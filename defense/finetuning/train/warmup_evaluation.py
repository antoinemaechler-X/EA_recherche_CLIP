import matplotlib.pyplot as plt
import os

file_to_save = "evaluation_ft"

loss_5 = [302.8834533691406, 20.165088653564453, 10.147679328918457, 7.340515613555908, 6.189534664154053, 6.55224609375, 6.109007835388184, 6.594313621520996, 6.179848670959473, 5.669687747955322, 6.5309624671936035, 6.615777492523193, 5.809220314025879, 5.484442710876465, 5.3083295822143555, 5.807810306549072, 5.880603790283203, 5.787566184997559, 6.059792518615723, 5.251916885375977, 6.006691932678223, 5.369823455810547, 5.058236598968506, 5.741883277893066, 5.25459623336792, 5.284688949584961, 5.063619136810303, 5.409850597381592, 5.1156206130981445, 5.233318328857422, 4.636361598968506, 5.171274185180664, 5.298480033874512, 4.86705207824707, 4.908021450042725, 4.66187047958374, 4.498599529266357, 4.950908660888672, 4.777982711791992, 4.985063552856445, 4.722649574279785, 4.922029972076416, 4.98964786529541, 4.73091983795166, 4.791399955749512, 4.727323532104492, 4.693236351013184, 4.736201286315918, 4.833473205566406, 4.798165321350098]
loss_50 = [302.8834533691406, 165.2566680908203, 20.459938049316406, 9.696564674377441, 6.834240436553955, 7.350081443786621, 5.926416397094727, 6.886133193969727, 6.715908527374268, 5.7276201248168945, 6.743746757507324, 6.9699835777282715, 6.020667552947998, 5.700110912322998, 5.290317535400391, 5.9340338706970215, 5.796732425689697, 5.58495569229126, 5.756582260131836, 5.441768169403076, 5.929140090942383, 5.355947971343994, 5.1339874267578125, 5.7071404457092285, 5.292824745178223, 5.267083644866943, 5.123162269592285, 5.407031536102295, 5.204437255859375, 5.340023517608643, 4.717960834503174, 5.240538120269775, 5.291736125946045, 4.895720958709717, 4.972472667694092, 4.733278274536133, 4.492028713226318, 5.010922908782959, 4.796380043029785, 5.00512170791626, 4.778112888336182, 4.973660945892334, 5.020382404327393, 4.7762885093688965, 4.829833030700684, 4.766993522644043, 4.7459917068481445, 4.759749889373779, 4.875672817230225, 4.827870845794678]
loss_200 = [302.8834533691406, 251.50390625, 183.87460327148438, 43.46682357788086, 17.76433563232422, 14.184768676757812, 8.84536361694336, 9.598100662231445, 6.899896144866943, 6.5949506759643555, 7.473138332366943, 9.37509536743164, 6.277052879333496, 5.952151298522949, 5.916109561920166, 6.250326156616211, 5.888412952423096, 6.1907172203063965, 6.56346321105957, 5.466087341308594, 6.4185967445373535, 5.974986553192139, 5.418037414550781, 6.065362930297852, 5.505047798156738, 5.466943740844727, 5.204966068267822, 5.651665687561035, 5.179173469543457, 5.385102272033691, 4.791834354400635, 5.417862415313721, 5.512052536010742, 5.043940544128418, 5.067587375640869, 4.795324325561523, 4.670807838439941, 5.064642429351807, 4.857990264892578, 5.061040878295898, 4.796741485595703, 5.031651973724365, 5.072563648223877, 4.835594177246094, 4.85322904586792, 4.784943103790283, 4.768660545349121, 4.8191752433776855, 4.9135637283325195, 4.862063884735107]


n = len(loss_50)

absc = [50*x for x in range(n)]

plt.figure(figsize=(8, 6))
plt.plot(absc, loss_5, color='blue', label="warmup = 5")
plt.plot(absc, loss_50, color='red', label="warmup = 50")
plt.plot(absc, loss_200, color='green', label="warmup = 200")

plt.title("Evolution of loss during training")
plt.xlabel("Steps")
plt.ylabel("Loss")

plt.legend()

plt.grid(True)
plt.savefig(os.path.join(file_to_save, "warmup_eval.png"))
plt.close()